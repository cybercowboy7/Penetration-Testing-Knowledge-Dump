PRE-ENGAGEMENT:

- Educating clients and adjusting the contract
- Arrangements are made to include:
  - NDA
      - Unilateral NDA	This type of NDA obligates only one party to maintain confidentiality and allows the other party to share the information received 
      with third parties.
      - Bilateral NDA	In this type, both parties are obligated to keep the resulting and acquired information confidential. This is the most common type 
      of NDA that protects the work of penetration testers.
      - Multilateral NDA	Multilateral NDA is a commitment to confidentiality by more than two parties. If we conduct a penetration test for a cooperative 
      network, all parties responsible and involved must sign this document.
  - Goals
  - Scope
  - Time Estimation
  - Rules of Engagement
- Common Documents needed prior to testing:
  1. Non-Disclosure Agreement (NDA)	After Initial Contact
  2. Scoping Questionnaire	Before the Pre-Engagement Meeting
  3. Scoping Document	During the Pre-Engagement Meeting
  4. Penetration Testing Proposal (Contract/Scope of Work (SoW))	During the Pre-engagement Meeting
  5. Rules of Engagement (RoE)	Before the Kick-Off Meeting
  6. Contractors Agreement (Physical Assessments)	Before the Kick-Off Meeting
  7. Reports	During and after the conducted Penetration Test 
- Scoping questionnaire
  - Clearly explain our services and may typically ask to choose one or more from the following list:
    - Internal Vulnerability assessment
    - Internal Penetration Test
    - Wireless Security Assessment
    - Physical Security Assessment
    - Red Team Assessment
    - External Vulnerability Assessment
    - External Penetration Test
    - Application Security Assessment
    - Social Engineering Assessment
    - Web Application Security Assessment
  - Other critical information can include:
    How many expected live hosts?	
    How many IPs/CIDR ranges in scope?	
    How many Domains/Subdomains are in scope?	
    How many wireless SSIDs in scope?	
    How many web/mobile applications? If testing is authenticated, how many roles (standard user, admin, etc.)?	
    For a phishing assessment, how many users will be targeted? Will the client provide a list, or we will be required to gather this list via OSINT?	
    If the client is requesting a Physical Assessment, how many locations? If multiple sites are in-scope, are they geographically dispersed?	
    What is the objective of the Red Team Assessment? Are any activities (such as phishing or physical security attacks) out of scope?	
    Is a separate Active Directory Security Assessment desired?	
    Will network testing be conducted from an anonymous user on the network or a standard domain user?	
    Do we need to bypass Network Access Control (NAC)?
    How invasive will they like us to test?
- Pre-engagement meeting
  - Contract Checklist:
    ☐ NDA	Non-Disclosure Agreement (NDA) refers to a secrecy contract between the client and the contractor regarding all written or verbal information 
    concerning an order/project. The contractor agrees to treat all confidential information brought to its attention as strictly confidential, even 
    after the order/project is completed. Furthermore, any exceptions to confidentiality, the transferability of rights and obligations, and contractual 
    penalties shall be stipulated in the agreement. The NDA should be signed before the kick-off meeting or at the latest during the meeting before any 
    information is discussed in detail.
    ☐ Goals	Goals are milestones that must be achieved during the order/project. In this process, goal setting is started with the significant goals and 
    continued with fine-grained and small ones.
    ☐ Scope	The individual components to be tested are discussed and defined. These may include domains, IP ranges, individual hosts, specific accounts, 
    security systems, etc. Our customers may expect us to find out one or the other point by ourselves. However, the legal basis for testing the 
    individual components has the highest priority here.
    ☐ Penetration Testing Type	When choosing the type of penetration test, we present the individual options and explain the advantages and 
    disadvantages. Since we already know the goals and scope of our customers, we can and should also make a recommendation on what we advise and justify 
    our recommendation accordingly. Which type is used in the end is the client's decision.
    ☐ Methodologies	Examples: OSSTMM, OWASP, automated and manual unauthenticated analysis of the internal and external network components, vulnerability 
    assessments of network components and web applications, vulnerability threat vectorization, verification and exploitation, and exploit development to 
    facilitate evasion techniques.
    ☐ Penetration Testing Locations	External: Remote (via secure VPN) and/or Internal: Internal or Remote (via secure VPN)
    ☐ Time Estimation	For the time estimation, we need the start and the end date for the penetration test. This gives us a precise time window to 
    perform the test and helps us plan our procedure. It is also vital to explicitly ask how time windows the individual attacks 
    (Exploitation / Post-Exploitation / Lateral Movement) are to be carried out. These can be carried out during or outside regular working hours. 
    When testing outside regular working hours, the focus is more on the security solutions and systems that should withstand our attacks.
    ☐ Third Parties	For the third parties, it must be determined via which third-party providers our customer obtains services. These can be cloud 
    providers, ISPs, and other hosting providers. Our client must obtain written consent from these providers describing that they agree and are aware 
    that certain parts of their service will be subject to a simulated hacking attack. It is also highly advisable to require the contractor to forward 
    the third-party permission sent to us so that we have actual confirmation that this permission has indeed been obtained.
    ☐ Evasive Testing	Evasive testing is the test of evading and passing security traffic and security systems in the customer's infrastructure. We look 
    for techniques that allow us to find out information about the internal components and attack them. It depends on whether our contractor wants us to 
    use such techniques or not.
    ☐ Risks	We must also inform our client about the risks involved in the tests and the possible consequences. Based on the risks and their potential 
    severity, we can then set the limitations together and take certain precautions.
    ☐ Scope Limitations & Restrictions	It is also essential to determine which servers, workstations, or other network components are essential for the 
    client's proper functioning and its customers. We will have to avoid these and must not influence them any further, as this could lead to critical 
    technical errors that could also affect our client's customers in production.
    ☐ Information Handling	HIPAA, PCI, HITRUST, FISMA/NIST, etc.
    ☐ Contact Information	For the contact information, we need to create a list of each person's name, title, job title, e-mail address, phone number, 
    office phone number, and an escalation priority order.
    ☐ Lines of Communication	It should also be documented which communication channels are used to exchange information between the customer and us. 
    This may involve e-mail correspondence, telephone calls, or personal meetings.
    ☐ Reporting	Apart from the report's structure, any customer-specific requirements the report should contain are also discussed. In addition, we 
    clarify how the reporting is to take place and whether a presentation of the results is desired.
    ☐ Payment Terms	Finally, prices and the terms of payment are explained.
  - Rules of Engagement Checklist:
    ☐ Introduction	Description of this document.
    ☐ Contractor	Company name, contractor full name, job title.
    ☐ Penetration Testers	Company name, pentesters full name.
    ☐ Contact Information	Mailing addresses, e-mail addresses, and phone numbers of all client parties and penetration testers.
    ☐ Purpose	Description of the purpose for the conducted penetration test.
    ☐ Goals	Description of the goals that should be achieved with the penetration test.
    ☐ Scope	All IPs, domain names, URLs, or CIDR ranges.
    ☐ Lines of Communication	Online conferences or phone calls or face-to-face meetings, or via e-mail.
    ☐ Time Estimation	Start and end dates.
    ☐ Time of the Day to Test	Times of the day to test.
    ☐ Penetration Testing Type	External/Internal Penetration Test/Vulnerability Assessments/Social Engineering.
    ☐ Penetration Testing Locations	Description of how the connection to the client network is established.
    ☐ Methodologies	OSSTMM, PTES, OWASP, and others.
    ☐ Objectives / Flags	Users, specific files, specific information, and others.
    ☐ Evidence Handling	Encryption, secure protocols
    ☐ System Backups	Configuration files, databases, and others.
    ☐ Information Handling	Strong data encryption
    ☐ Incident Handling and Reporting	Cases for contact, pentest interruptions, type of reports
    ☐ Status Meetings	Frequency of meetings, dates, times, included parties
    ☐ Reporting	Type, target readers, focus
    ☐ Retesting	Start and end dates
    ☐ Disclaimers and Limitation of Liability	System damage, data loss
    ☐ Permission to Test	Signed contract, contractors agreement
  - Contractors Agreement for Physical Assessments:
    ☐ Introduction
    ☐ Contractor
    ☐ Purpose
    ☐ Goal
    ☐ Penetration Testers
    ☐ Contact Information
    ☐ Physical Addresses
    ☐ Building Name
    ☐ Floors
    ☐ Physical Room Identifications
    ☐ Physical Components
    ☐ Timeline
    ☐ Notarization
    ☐ Permission to Test
- Kick-off meeting


INFORMATION GATHERING:

- How we obtain information about the necessary components in various ways
- Search for information about the target company and the software and hardware in use to find potential security gaps that we may be able ot leverage for
foothold
- Categories for Information Gathering:
  - OSINT: https://academy.hackthebox.com/course/preview/osint-corporate-recon
  - Infrastructure Enumeration:
    - Overview of company's position on the internet and intranet
    - Use DNS to create a map of the client's servers and hosts and develop an understanding of how their infrastructure is structured.
    - Includes name servers, mail servers, web servers, cloud instances, and more.
    - Make an accurate list of hosts and their IP addresses and compare them to our scope to see if they are included and listed.
  - Service Enumeration
    - What is the service?
    - What version is it?
  - Host Enumeration
    - What is the OS
    - What services it uses
    - What versions of services
    - internal host enumeration aims to look for sensitive files, local services, scripts, applications, information and other things.
  - Pillaging
    - Collect sensitive information locally on the exploited host such as employee names, customer data etc.


VULNERABILITY ASSESSMENT:

- Analyze results from Info gathering looking for known vulnerabilities in the systems, applications, and various versions of each to discover attack vectors
- Determines the threat level and susceptibility of a company's network infrastructure to cyber-attacks
- Common Vulnerabilities and Exposures (CVE): https://www.cve.org/ResourcesSupport/FAQs
- Common Places to find vulnerability disclosures:
  - https://www.cvedetails.com/
  - https://packetstorm.news/
  - https://www.exploit-db.com/
  - https://nvd.nist.gov/vuln/search?execution=e2s1
  - https://vulners.com/


EXPLOITATION:

- Use results to test our attacks against the potential vectors and executre them against target systems to gain initial access to those systems
- Prioritization of Possible Attacks:
  - Probability of Success
    - Utilize CVSS Scoring (https://nvd.nist.gov/vuln-metrics/cvss) using the calculator (https://nvd.nist.gov/vuln-metrics/cvss/v3-calculator)
    to better calculate the specific attacks and their probability of success
  - Complexity
  - Probability of Damage

POST-EXPLOITATION:

- Already have access, now we will ensure that we still have access even if modifications and changes are made
- Try to escalate privs to obtain highest possible rights and hunt for sensitive data such as credentials or other data that thte client is concerned with
protecting (pillaging).
- Helps demonstrate impact to the client
- This stage includes the following:
  - Evasive Testing
  - Pillaging
    - Interfaces
    - ARP
    - IP Subnets
    - Routing
    - Services
    - Shares
    - DNS
    - VPN
    - Network Traffic
  - Privilege Escalation
  - Data Exfiltration
  - Information Gathering
  - Vulnerability Assessment
  - Persistence
- Frameworks that companies may use:
  (NIST) - National Institute of Standards and Technology
  (ISO) - International Organization for Standardization
  (GDPR) - General Data Protection Regulation
  (FedRAMP) - The Federal Risk and Authorization Management Program
  (AICPA) - American Institute of Certified Public Accountants
  (CIS Controls) - Center for Internet Security Controls
  (PCI-DSS) - The Payment Card Industry Data Security Standard
  (COBIT) - Control Objectives for Information and Related Technologies
  (ITAR) - International Traffic in Arms Regulations
  (NERC CIP Standards) - NERC Critical Infrastructure Protection Standards

LATERAL MOVEMENT:

- Access additional hosts at the same or a higher priv level
- Rinse and repeat until objectives are achieved


PROOF-OF-CONCEPT:

- Document, step by step, the steps taken to achieve network compromise or some level of access.
- Paint the picture for the chain of events in order to help clients remediation efforts


POST-ENGAGEMENT:

- Detailed documentation is prepared for both admins and client company management to understand the severity of vulns
- Clean up all actions on all hosts and servers
- Create deliverables for client, hold a report walkthrough, and present
- Archive testing data per our contractual obligations and company policy.
